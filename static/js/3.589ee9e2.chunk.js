(this["webpackJsonpreact-samurai-way"]=this["webpackJsonpreact-samurai-way"]||[]).push([[3],{143:function(e,s,a){e.exports={userLink:"DialogItem_userLink__kC1n6",active:"DialogItem_active__2lnZy",time:"DialogItem_time__29Q1a",message:"DialogItem_message__1uTxW",messageCounter:"DialogItem_messageCounter__Q7lqM",avatar:"DialogItem_avatar__39V1I",avatarContainer:"DialogItem_avatarContainer__3prS6",name:"DialogItem_name__2zudr"}},144:function(e,s,a){e.exports={dialogsWrapper:"DialogsBlock_dialogsWrapper__13L6J",dialogs:"DialogsBlock_dialogs__3rX9O"}},145:function(e,s,a){e.exports={messagesBlock:"MessagesBlock_messagesBlock__2vaW7",textAreaWrapper:"MessagesBlock_textAreaWrapper__1LW0C",newMessageField:"MessagesBlock_newMessageField__3NOQX"}},146:function(e,s,a){e.exports={messenger:"MessengerPage_messenger__3apyR"}},148:function(e,s,a){"use strict";a.r(s);var t=a(14),n=a(2),r=a(18),i=a(17),o=a(43),c=a(77),l=a(78),g=a(71),u=a(41),h=a(10),d=a(11),m=a(19),f=a(143),j=a.n(f),M=a(0),p=function(e){var s=e.dialogItem,a=Object(d.e)(s.userName,26),t=9999999===s.id?"chat":s.id;return Object(M.jsx)("li",{children:Object(M.jsxs)(h.c,{className:Object(d.b)(j.a.userLink,j.a.active),to:"".concat(t),children:[Object(M.jsx)("div",{className:j.a.avatar,children:Object(M.jsx)(m.a,{photo:s.photos.small})}),Object(M.jsx)("div",{className:j.a.name,children:a}),Object(M.jsx)("p",{className:j.a.message,children:Object(d.e)("last message placeholder",26)}),Object(M.jsx)("time",{className:j.a.time,children:Object(d.a)(s.lastDialogActivityDate,!1)}),s.newMessagesCount>0&&Object(M.jsx)("div",{className:j.a.messageCounter,children:s.newMessagesCount})]})})},v=a(144),_=a.n(v),b=function(e){var s=e.dialogs;return Object(M.jsx)("div",{className:_.a.dialogsWrapper,children:Object(M.jsx)("ul",{className:_.a.dialogs,children:s.map((function(e){return Object(M.jsx)(p,{dialogItem:e},e.id)}))})})},O=a(7),D=a(145),x=a.n(D),P=a(91),k=function(e){var s=e.pathName,a=e.isDialogSelected,t=e.authProfileId,r=e.authProfilePhoto,i=e.messages,o=e.currentDialog,c=e.navigate,l=e.fetchChatMessagesStatus,g=e.fetchMessagesPending,u=e.sendMessage,h=Object(n.useState)(""),d=Object(O.a)(h,2),m=d[0],f=d[1],j=9999999===(o&&o.id);Object(n.useEffect)((function(){var e=function(e){"Escape"===e.key&&g.every((function(e){return e!==o.id}))&&c("messenger")};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[]);return Object(M.jsxs)("div",{className:x.a.messagesBlock,children:[Object(M.jsx)(P.a,{pathName:s,authProfileId:t,authProfilePhoto:r,currentDialog:o,isDialogSelected:a,messages:i,fetchChatMessagesStatus:l,fetchMessagesPending:g}),a&&Object(M.jsx)("div",{className:x.a.textAreaWrapper,children:Object(M.jsx)("textarea",{value:m,disabled:"pending"===l&&j,placeholder:"ready"!==l&&j?"Reconnect to the channel..":"Write message",className:x.a.newMessageField,onKeyDown:function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),u(m),f(""))},onChange:function(e){return f(e.target.value)}})})]})},C=a(146),I=a.n(C),N=function(e){var s=e.isDialogSelected,a=e.authProfileId,t=e.authProfilePhoto,n=e.interlocutorId,r=e.pathName,i=e.dialogs,o=e.messages,c=e.fetchChatMessagesStatus,l=e.fetchMessagesPending,g=e.navigate,u=e.sendMessage,h=i.filter((function(e){return e.id===n}))[0];return Object(M.jsxs)("div",{className:I.a.messenger,children:[Object(M.jsx)(b,{dialogs:i}),Object(M.jsx)(k,{pathName:r,currentDialog:h,isDialogSelected:s,authProfileId:a,authProfilePhoto:t,messages:o,sendMessage:u,fetchChatMessagesStatus:c,fetchMessagesPending:l,navigate:g})]})},w={fetchDialogsThunk:u.b,fetchMessagesThunk:u.c,sendMessageThunk:u.d,sendChatMessageThunk:g.a},E=Object(r.b)((function(e){var s,a,t;return{dialogs:e.messenger.dialogs,dialogMessages:e.messenger.messages,chatMessages:e.chat.messages,authProfilePhoto:null===(s=e.auth.user)||void 0===s||null===(a=s.photos)||void 0===a?void 0:a.small,fetchChatMessagesStatus:e.chat.requests.fetchChatMessagesStatus,fetchMessagesPending:e.messenger.requests.fetchMessagesPending,createDialogError:e.messenger.requests.createDialogError,fetchMessagesError:e.messenger.requests.fetchMessagesError,fetchDialogsError:e.messenger.requests.fetchMessagesError,sendMessageError:e.messenger.requests.sendMessageError,authProfileId:null===(t=e.auth.user)||void 0===t?void 0:t.id}}),w);s.default=Object(i.compose)(E,l.a,c.a)((function(e){var s=e.route,a=e.dialogs,r=e.dialogMessages,i=e.chatMessages,c=e.authProfileId,l=e.authProfilePhoto,g=e.fetchChatMessagesStatus,u=e.fetchMessagesPending,h=e.fetchMessagesError,d=e.fetchDialogsError,m=e.sendMessageError,f=e.fetchDialogsThunk,j=e.fetchMessagesThunk,p=e.sendMessageThunk,v=e.sendChatMessageThunk,_=parseInt(s.params.userId),b="/messenger/chat"===s.location.pathname,O=!(!b&&!_),D=(b?i:r[_])||[],x=b?v:p.bind(null,_),P=[{id:9999999,userName:"WebSocket Chat",hasNewMessages:!0,lastDialogActivityDate:"2022-05-20T23:06:26.437",lastUserActivityDate:"2022-05-20T23:06:26.437",newMessagesCount:0,photos:{small:null,large:null}}].concat(Object(t.a)(a));return Object(n.useEffect)((function(){f()}),[f]),Object(n.useEffect)((function(){D[_]||_&&j(_)}),[_]),Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(o.a,{titlesArray:[h,d,m]}),Object(M.jsx)(N,{navigate:s.navigate,pathName:s.location.pathname,interlocutorId:_||9999999,isDialogSelected:O,authProfilePhoto:l,authProfileId:c,dialogs:P,messages:D,sendMessage:x,fetchChatMessagesStatus:g,fetchMessagesPending:u})]})}))}}]);
//# sourceMappingURL=3.589ee9e2.chunk.js.map